#!/usr/bin/env node
'use strict';

Object.defineProperty(exports, "__esModule", {
  value: true
});

var _cli = require('cli');

var _cli2 = _interopRequireDefault(_cli);

var _fs = require('fs');

var _fs2 = _interopRequireDefault(_fs);

var _mkdirp = require('mkdirp');

var _mkdirp2 = _interopRequireDefault(_mkdirp);

var _createTemplates = require('./createTemplates.js');

var _createTemplates2 = _interopRequireDefault(_createTemplates);

var _createQuery = require('./createQuery.js');

var _createQuery2 = _interopRequireDefault(_createQuery);

var _createSubclass = require('./createSubclass.js');

var _createSubclass2 = _interopRequireDefault(_createSubclass);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

var buildTemplatesFromConfig = function buildTemplatesFromConfig() {
  _fs2.default.readFile('./.timber', 'utf8', function (err, res) {
    if (err) {
      console.log(err);
    } else {
      console.log('Building...');
      parseFile(res);
    }
  });

  function parseFile(file) {
    var Types = JSON.parse(file);

    Object.keys(Types).map(function (type) {
      var BuildType = Types[type];
      Object.keys(BuildType).map(function (name) {
        var args = [type, name];
        (0, _createTemplates2.default)(args);

        var Queries = BuildType[name].queries;
        if (Queries) {
          Object.keys(Queries).map(function (query, index) {
            setTimeout(function () {
              var queryArgs = [type, name, query, Queries[query]];
              (0, _createQuery2.default)(queryArgs, true);
            }, 10 * (index + 1));
          });
        }
      });
    });
  }
};

exports.default = buildTemplatesFromConfig;